1 2 GfsAdvection GfsBox GfsGEdge {} {
  Time { end = 2.236067 }
  Refine LEVEL
  VariableTracer {} T {
    gradient = gfs_center_gradient
  }
  AdvectionParams { cfl = 0.5 }
  Init {} {
    U = { double theta = atan (1./2.); return cos (theta); }
    V = { double theta = atan (1./2.); return sin (theta); }
    T = { 
      double r2 = x*x + y*y; 
      double coeff = 20. + 20000.*r2*r2*r2*r2;
      return (1. + cos(20.*x)*cos(20.*y))*exp(-coeff*r2)/2.;
    }
  }
  OutputErrorNorm { start = end } { awk '{ print LEVEL " " $5 " " $7 " " $9}' } { v = T } {
    s = {
      double r2 = x*x + y*y; 
      double coeff = 20. + 20000.*r2*r2*r2*r2;
      return (1. + cos(20.*x)*cos(20.*y))*exp(-coeff*r2)/2.;
    }
  }
}
GfsBox {}
1 1 right
1 1 top
